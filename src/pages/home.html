<style>
    #cartsContainer {
        display: flex;
        flex-direction: row;
        justify-content: center;
        flex-wrap: wrap;
    }

    .cartBox {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: top;
        margin: 10px;
        width: 200px;
        border: 2.5px solid black;
        border-radius: 10px;
        background: var(--color-content-background-secondary);
    }

    .cartBox:hover .cartHeader {
        text-decoration: underline;
    }

    .cartHeader {
        width: 100%;
        font-size: 20px;
        padding: 10px 0px;
        text-align: center;
        font-weight: bold;
    }

    .cartPicture {
        min-width: 144px;
        min-height: 320px;
        border-radius: 10px;
        margin: 0px;
    }

    .cartName {
        text-align: center;
        padding: 10px 0px;
    }

    @media only screen and (max-width: 500px) {
        .cartBox {
            width: 150px !important;
        }

        .cartPicture {
            min-width: 108px;
            min-height: 240px;
        }
    }
</style>

<body>
    <h2 class="center"><img src="/assets/icons/cart.png">CARTS</h2>
    <p class="center">Choose a cart to view more information.</p>
    <hr>
    <!-- <a class="normal rounded full small" data-page="cartDetails">Trolley 1</a> -->
    <div id="cartsContainer">

    </div>
    <hr>
    <a class='normal rounded full medium' onclick="addCart()"><img src='/assets/icons/add.png'>Add
        new cart</a>
    <h2 class="center"><img src="/assets/icons/settings.png">Manage information</h2>
    <a class='normal rounded full medium' data-page='designs'><img src='/assets/icons/list.png'>Designs</a>
    <a class='normal rounded full medium' data-page='covers'><img src='/assets/icons/cover.png'>Covers</a>
    <a class='normal rounded full medium' data-page='library'><img src='/assets/icons/shelf.png'>Library</a>
    <a class='normal rounded full medium' data-page='editLocations'><img src='/assets/icons/mapPin.png'>Locations</a>
    <a class='normal rounded full medium' data-page='settings'><img src='/assets/icons/settings.png'>Settings</a>
</body>
<script>
    function initCarts() {
        const cartsContainer = document.getElementById('cartsContainer');

        if (Object.keys(data.carts).length === 0) {
            cartsContainer.innerHTML = "<p class='center'>You don't have any carts registered yet.</p>";
        } else {
            for (const cartIndex in data.carts) {
                const cart = data.carts[cartIndex];

                let location;
                if (cart.locationID in data.locations) {
                    location = data.locations[cart.locationID].name;
                } else {
                    location = "No location";
                }

                const cartBox = document.createElement('div');
                cartBox.className = "cartBox";
                cartBox.addEventListener('click', () => {
                    session.currentCartIndex = cartIndex;
                });

                cartBox.dataset.page = "cartDetails";
                cartBox.innerHTML = "<img class='cartPicture' src='/assets/cartCovers/" + globals.covers[data.designs[cart.designID].coverID].fileName + "'><div class='cartHeader'>" + cart.number + ". " + cart.name + "</div><div class='cartName'>" + location + "</div></div>";

                cartsContainer.appendChild(cartBox);
            }
        }
    }

    initCarts();

    function addCart() {
        const availableIndex = getAvailableIndex(data.carts);

        const newCart = { ...defaultData.cart };
        newCart.number = availableIndex + 1;

        if (Object.keys(data.designs).length === 0) {
            const newDesign = { ...defaultData.design };
            newDesign.creationDate = new Date().toISOString().split('T')[0];
            data.designs[availableIndex] = newDesign;
        } else {
            newCart.designID = Object.keys(data.designs)[0];
        }

        data.carts[availableIndex] = newCart;
        session.currentCartIndex = availableIndex;
        session.newCart = true;

        loadPage("editCart");
    }

</script>